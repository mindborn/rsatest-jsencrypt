import { Component } from '@angular/core';
import { HashUtil } from './hash-util';

declare var JSEncrypt;

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  title = 'rsatest';

  public constructor() {
    console.log('hello');
    const jse = new JSEncrypt(
      // {
      //   default_key_size: 1024
      // }
    );
    console.log(jse);
    

    jse.setPublicKey('305C300D06092A864886F70D0101010500034B003048024100990AF3700D5E40D57D50B6DA00138BED7CE4D914822AFC406585AEE04A276DDF746C65EAC0932C9B35D65EB8F7BC26A4885C86D768AFB044CF8EA44155B16F7F0203010001');
    const encrypted = jse.encrypt('hello');

    console.log(encrypted);

    jse.setPrivateKey('30820154020100300D06092A864886F70D01010105000482013E3082013A020100024100990AF3700D5E40D57D50B6DA00138BED7CE4D914822AFC406585AEE04A276DDF746C65EAC0932C9B35D65EB8F7BC26A4885C86D768AFB044CF8EA44155B16F7F020301000102405DF5A737E83D31B8E0D3292FF65409D8A89127E5BB7500A1D8B29687057FE7A811FE52B973D860D669A56FB5516A6D2E1336FC7424430F9B9F717F9265149E01022100CBF4B76E799A0EE01675ECB9DCB6314B5EBDA0D51A2844CDE080C5931E1E543F022100C0185E0A385A6E97C1C5EE4025F160DEE6257AB7CF7D097DB5A1D76D920114C102202E393F1D5D97E9C925AE0241B960DD592C96A38DC888D9D7230B6C3BC476B13702210090C08BF4B59C67A411CFBE0636D15A86FCF49731F5B7AA34416F706FCFCAE2C10220506A52333593141E90D2CCDDD76644615645AE1FB84016D07CA4C04B9A839CD2');
    const decrypted = jse.decrypt(encrypted);

    console.log(decrypted);

    let hash=HashUtil.hash('hellohellohellohellohello');
    console.log('hash',hash);

    let sign=jse.sign('hello','SHA-512');
    console.log('sign',sign);
  }
}
